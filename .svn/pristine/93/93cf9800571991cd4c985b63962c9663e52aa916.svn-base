from service.status import OperationStatus
from natspec_utils.decorators import TextSyntax
class ValidationSupport():
    def __init__(self, flight, passenger):
        self.flight = flight
        self.passenger = passenger
        self.status = OperationStatus()
        
    def set_invalid(self, msg):
        self.status.valid = False
        self.status.msg = msg
        
    @TextSyntax("Each Passenger can only be booked once.")
    def check_unique_passenger(self):
        if self.passenger.id in self.flight.passenger_ids:
            self.set_invalid("A passenger can only be booked once for each flight.")
            
    @TextSyntax("There should be at least #1 free seats to handle overbooking.", types=["int"])
    def check_free_seats_with_buffer(self, overbooking_buffer):
        if self.flight.free_seats < overbooking_buffer:
            self.set_invalid("There are no free seats for the flight.")
            
    @TextSyntax("There needs to be a free seat for the passenger.")
    def check_free_seats(self):
        if self.flight.free_seats < 1:
            self.set_invalid("There are no free seats for the flight.")
            
    @TextSyntax("The Passenger needs to be at least #1 years old.", types=["int"])
    def passenger_needs_to_be_at_least_years_old(self, minimal_age):
        if self.passenger.age < minimal_age:
            self.set_invalid("The passenger needs to be at least {0} years.".format(minimal_age))
        
    
